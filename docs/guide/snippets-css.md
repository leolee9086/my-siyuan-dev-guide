# CSS 代码片段指南

## 定义

CSS 代码片段 (Code Snippet) 是思源笔记提供的一种轻量级界面定制方式。它允许用户直接编写 CSS 代码来调整思源笔记的视觉外观。

> 如果你对 CSS 还不太熟悉，推荐先学习基础知识。**[菜鸟教程 CSS](https://www.runoob.com/css/css-tutorial.html)** 是一个不错的起点。

## 如何管理

*   **入口**: 你可以在 "设置" -> "外观" -> "代码片段" 区域找到管理界面。
*   **操作**: 在这里，你可以添加新的 CSS 片段、编辑现有片段、为片段命名、启用或禁用特定片段，以及启用或禁用所有 CSS 片段的总开关。
*   **存储**: 这些片段的内容由思源笔记在本地负责存储和管理。

## 加载机制

当思源启动或相关设置更新时，前端会：
1.  通过内部 API (`/api/snippet/getSnippet`) 获取所有已保存且标记为启用的 CSS 片段内容。
2.  检查 CSS 片段的总开关 (`window.siyuan.config.snippet.enabledCSS`) 是否开启。
3.  如果总开关开启且片段自身也启用，则将该段 CSS 代码动态地创建一个 `<style>` 标签（例如 `<style id="snippetCSS{片段ID}">...</style>`）。
4.  将这个 `<style>` 标签插入到当前 HTML 文档的 `<head>` 元素中。

## 作用域

由于 CSS 片段是通过 `<style>` 标签直接插入到 `<head>` 中的，它们的**作用域是全局的**。这意味着你编写的 CSS 规则会影响整个思源笔记的界面。

## 主要用途

*   **微调主题**: 对当前使用的主题进行细节调整。
*   **修改元素样式**: 改变特定界面元素（如按钮、面板、字体）的大小、颜色、边距等。
*   **隐藏元素**: 使用 `display: none;` 隐藏你不需要的界面元素。
*   **引入自定义字体**: 使用 `@font-face` 规则引入本地或网络字体。
*   **覆盖样式**: 覆盖主题或插件提供的某些现有样式。

## 局限性

*   只能编写标准的 CSS 代码，无法实现动态逻辑。
*   对思源 DOM 结构的依赖：如果你的 CSS 选择器依赖于非常特定的 DOM 结构，当思源版本更新导致结构变化时，样式可能会失效。

## 调试

调试 CSS 片段的最佳方式是使用浏览器的开发者工具（通常按 F12 或通过右下角菜单打开）：

1.  **检查元素**: 在"元素"（Elements）面板中，找到你想要修改的界面元素。
2.  **查看样式**: 在"样式"（Styles）面板中，可以看到应用到该元素的所有 CSS 规则，包括来自你的代码片段的规则（通常可以通过其 `<style>` 标签的 ID 识别，如 `#snippetCSS...`）。
3.  **实时编辑**: 你可以直接在"样式"面板中修改 CSS 规则，实时预览效果。调试满意后，再将最终的代码复制回思源的代码片段设置中保存。 